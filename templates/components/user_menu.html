<!-- 用户菜单组件 -->
<!-- 用户图标 -->
<div class="user-icon" id="userIcon">
    <i class="fas fa-user-circle text-primary text-xl"></i>
</div>

<!-- 用户菜单，默认隐藏 -->
<div class="user-menu" id="userMenu">
    <!-- 用户信息 -->
    <div class="flex items-center px-4 py-3 border-b border-gray-100">
        <i class="fas fa-user-circle text-primary text-xl"></i>
        <span class="ml-2 text-gray-700 font-medium">
            {{ session.get('username', '未登录').split('@')[0] }}
        </span>
    </div>
    
    <!-- 系统设置选项 -->
    <div class="flex items-center px-4 py-3 border-b border-gray-100 hover:bg-gray-50 cursor-pointer hidden">
        <i class="fas fa-cog text-gray-500"></i>
        <span class="ml-2 text-gray-700">系统设置</span>
    </div>
    
    <!-- 用户指南选项 -->
    <a href="{{ url_for('user_guide') }}" class="flex items-center px-4 py-3 border-b border-gray-100 hover:bg-gray-50 cursor-pointer">
        <i class="fas fa-book text-gray-500"></i>
        <span class="ml-2 text-gray-700">用户使用指南</span>
    </a>
    
    <!-- 联系我们选项 -->
    <div id="contactUsBtn" class="flex items-center px-4 py-3 border-b border-gray-100 hover:bg-gray-50 cursor-pointer">
        <i class="fas fa-paper-plane text-gray-500"></i>
        <span class="ml-2 text-gray-700">联系我们</span>
    </div>
    
    <!-- 退出登录选项 -->
    <a href="{{ url_for('logout') }}" class="flex items-center px-4 py-3 hover:bg-gray-50 cursor-pointer group">
        <i class="fas fa-sign-out-alt text-gray-500 group-hover:text-red-500"></i>
        <span class="ml-2 text-gray-700 group-hover:text-red-500">退出登录</span>
    </a>
</div>

<!-- 联系我们模态框 -->
<div id="contactModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
    <div class="bg-white rounded-lg shadow-xl w-full max-w-md p-6">
        <div class="flex justify-between items-center mb-4">
            <h3 class="text-xl font-bold">联系我们</h3>
            <button class="text-gray-500 hover:text-gray-700" onclick="closeContactModal()" title="关闭">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="space-y-4">
            <div class="flex items-center space-x-3">
                <i class="fas fa-envelope text-primary text-xl"></i>
                <div>
                    <p class="text-gray-700 font-medium">Email：</p>
                    <p class="text-gray-600">acbim@qq.com</p>
                </div>
            </div>
            <div class="flex items-center space-x-3">
                <i class="fab fa-qq text-primary text-xl"></i>
                <div>
                    <p class="text-gray-700 font-medium">用户服务QQ群：</p>
                    <p class="text-gray-600">715172744</p>
                </div>
            </div>
        </div>
        <div class="mt-6 flex justify-end">
            <button onclick="closeContactModal()" class="px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary/90">
                关闭
            </button>
        </div>
    </div>
</div>

<!-- 用户菜单相关样式 -->
<style>
/* 用户菜单样式 */
.user-icon {
    position: fixed;
    left: 20px;
    bottom: 20px;
    z-index: 60;
    width: 42px;
    height: 42px;
    background-color: white;
    border-radius: 50%;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.2s;
}

.user-icon:hover {
    transform: scale(1.05);
}

.user-menu {
    position: fixed;
    left: 20px;
    bottom: 72px;
    z-index: 50;
    background-color: white;
    border-radius: 10px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    width: 170px;
    transition: all 0.3s ease;
    transform-origin: bottom left;
    opacity: 0;
    transform: scale(0.95);
    pointer-events: none;
}

.user-menu.active {
    opacity: 1;
    transform: scale(1);
    pointer-events: auto;
}
</style>

<!-- 用户菜单相关脚本 -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    // 用户菜单相关的JavaScript
    const userIcon = document.getElementById('userIcon');
    const userMenu = document.getElementById('userMenu');
    const contactUsBtn = document.getElementById('contactUsBtn');
    const contactModal = document.getElementById('contactModal');

    // 点击用户图标显示菜单
    userIcon.addEventListener('click', function(e) {
        e.stopPropagation();
        userMenu.classList.toggle('active');
    });

    // 点击联系我们显示联系信息模态框
    contactUsBtn.addEventListener('click', function(e) {
        e.stopPropagation();
        userMenu.classList.remove('active');
        contactModal.classList.remove('hidden');
    });

    // 关闭模态框
    window.closeContactModal = function() {
        contactModal.classList.add('hidden');
    };

    // 点击页面其他区域关闭菜单和模态框
    document.addEventListener('click', function(e) {
        if (!userMenu.contains(e.target) && !userIcon.contains(e.target)) {
            userMenu.classList.remove('active');
        }
        if (e.target === contactModal) {
            closeContactModal();
        }
    });
});
</script> 